<!DOCTYPE html>
<html>
<head>
    <title>Debug Login - LifeCalling</title>
</head>
<body>
    <h1>Debug Login Test</h1>
    <button onclick="testLogin()">Test Login</button>
    <button onclick="checkCookies()">Check Cookies</button>
    <button onclick="testDebugEndpoint()">Test Debug Endpoint</button>

    <div id="output"></div>

    <script>
        const output = document.getElementById('output');

        async function testLogin() {
            output.innerHTML = '<h2>Testing Login...</h2>';

            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'include',
                    body: JSON.stringify({
                        email: 'admin@demo.local',
                        password: '123456'
                    })
                });

                const result = await response.text();
                output.innerHTML += `<p><strong>Response Status:</strong> ${response.status}</p>`;
                output.innerHTML += `<p><strong>Response Headers:</strong></p><pre>${JSON.stringify([...response.headers.entries()], null, 2)}</pre>`;
                output.innerHTML += `<p><strong>Response Body:</strong></p><pre>${result}</pre>`;

            } catch (error) {
                output.innerHTML += `<p><strong>Error:</strong> ${error.message}</p>`;
            }
        }

        function checkCookies() {
            output.innerHTML = '<h2>Current Cookies:</h2>';
            output.innerHTML += `<pre>${document.cookie || 'No cookies found'}</pre>`;
        }

        async function testDebugEndpoint() {
            output.innerHTML = '<h2>Testing Debug Endpoint...</h2>';

            try {
                const response = await fetch('/api/auth/debug/cookies', {
                    credentials: 'include'
                });

                const result = await response.json();
                output.innerHTML += `<p><strong>Debug Response:</strong></p><pre>${JSON.stringify(result, null, 2)}</pre>`;

            } catch (error) {
                output.innerHTML += `<p><strong>Error:</strong> ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>